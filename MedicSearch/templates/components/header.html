<header>
    <div class="header-grid">
        <div class="logo">
            <a href="{{ url_for('index') }}" class="logo-link">
                <h1>MEDICSEARCH</h1>
                <span class="tagline">BASE DE DONNÉES MÉDICAMENTEUSE</span>
            </a>
        </div>
        <nav>
            <ul>
                <li><a href="{{ url_for('search') }}" {% if active_page == 'search' %}class="active"{% endif %}>RECHERCHE</a></li>
                {% if user %}
                    {% if user.role >= 4 %}
                    <!-- Menu admin visible uniquement pour les administrateurs -->
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle {% if active_page == 'admin' %}active{% endif %}">
                            <i class="fas fa-shield-alt"></i> ADMIN <i class="fas fa-caret-down"></i>
                        </a>
                        <div class="dropdown-menu">
                            <a href="{{ url_for('users.admin_users') }}">Gestion des utilisateurs</a>
                            <a href="{{ url_for('users.admin_roles') }}">Gestion des rôles</a>
                            <a href="{{ url_for('users.admin_database') }}">Base de données</a>
                        </div>
                    </li>
                    {% endif %}
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle {% if active_page == 'profile' %}active{% endif %}">
                            <i class="fas fa-user"></i> MON COMPTE <i class="fas fa-caret-down"></i>
                        </a>
                        <div class="dropdown-menu">
                            <a href="{{ url_for('users.profile') }}">Mon profil</a>
                            <a href="{{ url_for('users.favorites') }}">Mes favoris</a>
                            <a href="{{ url_for('users.logout') }}">Déconnexion</a>
                        </div>
                    </li>
                {% else %}
                    <li><a href="{{ url_for('users.login') }}" {% if active_page == 'login' %}class="active"{% endif %}>CONNEXION</a></li>
                    <li><a href="{{ url_for('users.register') }}" {% if active_page == 'register' %}class="active"{% endif %}>INSCRIPTION</a></li>
                {% endif %}
            </ul>
        </nav>
        <div class="header-search">
            <form action="{{ url_for('search') }}" method="get">
                <input type="text" name="search" placeholder="Rechercher un médicament..." class="search-input">
                <button type="submit" class="search-button"><i class="fas fa-search"></i></button>
            </form>
        </div>
    </div>
</header>
<style>
    .logo-link {
        text-decoration: none;
        color: inherit;
    }
    
    .login-btn {
        background-color: #e53935;
        color: white !important;
        padding: 8px 16px;
        border-radius: 4px;
        transition: background-color 0.3s;
    }
    
    .login-btn:hover {
        background-color: #c62828;
    }
    
    /* Styles pour le menu déroulant */
    .dropdown {
        position: relative;
        display: inline-block;
    }
    
    .dropdown-toggle {
        cursor: pointer;
        display: flex;
        align-items: center;
    }
    
    .dropdown-toggle i.fa-caret-down {
        margin-left: 5px;
        font-size: 0.8rem;
    }
    
    .dropdown-menu {
        display: none;
        position: absolute;
        background-color: white;
        min-width: 160px;
        box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.2);
        z-index: 1000;
        border-radius: 4px;
        right: 0;
    }
    
    .dropdown-menu a {
        color: black;
        padding: 12px 16px;
        text-decoration: none;
        display: block;
        font-size: 0.9rem;
        text-transform: none;
    }
    
    .dropdown-menu a:hover {
        background-color: #f1f1f1;
        color: #e53935;
    }
    
    .dropdown:hover .dropdown-menu {
        display: block;
    }
</style>
<script>
    document.addEventListener('DOMContentLoaded', function() {
        // Gérer les clics en dehors des menus déroulants pour les fermer
        document.addEventListener('click', function(e) {
            const dropdowns = document.querySelectorAll('.dropdown-menu');
            if (!e.target.matches('.dropdown-toggle') && !e.target.closest('.dropdown-menu')) {
                dropdowns.forEach(dropdown => {
                    dropdown.style.display = 'none';
                });
            }
        });
        
        // Toggle manuel pour les menus déroulants
        document.querySelectorAll('.dropdown-toggle').forEach(toggle => {
            toggle.addEventListener('click', function(e) {
                e.preventDefault();
                const menu = this.nextElementSibling;
                if (menu.style.display === 'block') {
                    menu.style.display = 'none';
                } else {
                    // Fermer tous les autres menus
                    document.querySelectorAll('.dropdown-menu').forEach(dropdown => {
                        dropdown.style.display = 'none';
                    });
                    menu.style.display = 'block';
                }
            });
        });
    });
</script>
